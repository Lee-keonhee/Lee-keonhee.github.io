---
layout: post
title:  "이미지 파이프라인"
date:   2025-08-14 09:00:00 +0900
categories: [딥러닝, 인공지능, 데이터과학]
tags: [딥러닝 기초]
---
---
## 1. 이미지 파이프라인
---
이미지 파이프라인은 원본 이미지 파일을 모델 학습에 적합한 형태로 입력하기 위한 처리 단계를 의미
데이터 수집- 전처리(리사이즈, 정규화) - 증강 - Batch 화 등으로 이어지는 전체의 흐름

---

## 2. 이미지 파이프라인의 핵심 구성요소
---
- 데이터 수집 및 저장:
파일 시스템, 아카이브(tar/webdataset), DB(LMDB/TFRecord) 등으로 원본을 관리합니다.
- 로드(I/O): 
이미지 파일 읽기, 캐시, prefetch 등을 통해 디스크/네트워크 병목을 완화합니다.
- 전처리(Deterministic): 
리사이즈, 센터크롭, 정규화 등 검증/추론용 일관된 처리.
- 증강(Augmentation): 
학습용 무작위 변형(회전, 플립, 색상 변화 등) — on-the-fly 또는 오프라인 저장 방식 선택.
- 배치화 및 전송: 
DataLoader 설정, num_workers, prefetch, pin_memory 등으로 GPU로의 전달을 최적화합니다.
- 캐싱/아카이빙: 
변환 비용이 크면 오프라인으로 변환해 저장하거나 메모리/디스크 캐시 사용.
- 모니터링·로깅: 
입력 품질 검사, 샘플 시각화, 메타데이터(어떤 증강을 적용했는지) 기록.
- 배포 파이프라인(추론용): 
모델 서빙 앞단에서의 전처리·후처리와 모델 인퍼런스 흐름(클라우드 파이프라인으로 구성 가능)


---
## 3. 이미지 파이프라인 최적화 라이브러리
---

- torchvision
transforms, DataLoader 등 파이프라인의 기준점 제공
- Albumentations
빠르고 유연한 증강 라이브러리, 다양한 변환을 효율적으로 구성
- Kornia
Pytorch 텐서 상에서 GPU로 증강을 수행할 수 있음, CPU 병목 해소
- Nvidia Dali
데이터 로딩/전처리/증강을 GPU에서 처리해 대규모 학습에서 CPU 병목을 해소
- pyvips / libvips / sharp (Node용) 
대용량 이미지를 고속으로 리사이즈·변형할 때 탁월한 성능을 보이는 라이브러리(특히 오프라인 전처리에서 유리). sharp는 libvips 기반의 고성능 도구

---
### 단계별 라이브러리 선택
- 개발 및 디버깅 
torchvision + Albumentations // konia
- 본 훈련
DALI // konia + DataLoader 튜닝
- 오프라인 대량 전처리(리사이즈/캐시)
pyvips // sharp